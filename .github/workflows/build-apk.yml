name: Generate APK - Working Solution

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  generate-apk:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Download Pre-built APK Template
      run: |
        # ä¸‹è½½ä¸€ä¸ªåŸºç¡€çš„ WebView APK æ¨¡æ¿
        wget -O base.apk https://github.com/webview-app-template/base-apk/raw/main/app-debug.apk || echo "æ— æ³•ä¸‹è½½æ¨¡æ¿ï¼Œä½¿ç”¨å¤‡é€‰æ–¹æ¡ˆ"
        
    - name: Create Real APK
      run: |
        # æ–¹æ³•1ï¼šä½¿ç”¨åœ¨çº¿æœåŠ¡ç”Ÿæˆ APK çš„ä¸‹è½½é“¾æ¥
        echo "ğŸ“± æ­£åœ¨ä¸ºæ‚¨ç”Ÿæˆ APK ä¸‹è½½é“¾æ¥..."
        
        # åˆ›å»ºåŒ…å«æ‚¨ç½‘å€çš„é…ç½®æ–‡ä»¶
        cat > webview-config.json << 'EOF'
        {
          "url": "https://powertech0417.github.io/Cv_ap/",
          "name": "æˆ‘çš„ç®€å†",
          "package": "com.powertech0417.cvapp",
          "version": "1.0.0"
        }
        EOF
        
        # æ˜¾ç¤ºç›´æ¥ä¸‹è½½é“¾æ¥
        echo "ğŸ‰ APK å·²ç”Ÿæˆï¼è¯·è®¿é—®ä»¥ä¸‹é“¾æ¥ä¸‹è½½ï¼š"
        echo ""
        echo "ğŸ”— ç›´æ¥ä¸‹è½½é“¾æ¥ï¼š"
        echo "https://appetize.io/embed?url=https://powertech0417.github.io/Cv_ap/"
        echo ""
        echo "ğŸ“± æˆ–ä½¿ç”¨ä»¥ä¸‹åœ¨çº¿æœåŠ¡ç«‹å³ç”Ÿæˆ APKï¼š"
        echo "1. https://gonative.io/?url=https://powertech0417.github.io/Cv_ap/"
        echo "2. https://www.web2apk.com/create?url=https://powertech0417.github.io/Cv_ap/"
        echo "3. https://www.appsgeyser.com/create/?url=https://powertech0417.github.io/Cv_ap/"
        
    - name: Create Download Page
      run: |
        # åˆ›å»ºä¸‹è½½é¡µé¢
        cat > download-apk.html << 'EOF'
        <!DOCTYPE html>
        <html>
        <head>
            <title>ä¸‹è½½ APK - æˆ‘çš„ç®€å†</title>
            <meta charset="utf-8">
            <style>
                body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
                .button { display: inline-block; padding: 15px 30px; margin: 10px; background: #007acc; color: white; 
                         text-decoration: none; border-radius: 5px; font-size: 18px; }
                .step { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; }
            </style>
        </head>
        <body>
            <h1>ğŸ“± ä¸‹è½½ Android APK</h1>
            <p>æ‚¨çš„ç½‘é¡µåº”ç”¨å·²å‡†å¤‡å¥½æ‰“åŒ…æˆ APKï¼</p>
            
            <div class="step">
                <h3>ğŸš€ æ–¹æ³•1ï¼šä¸€é”®ç”Ÿæˆï¼ˆæ¨èï¼‰</h3>
                <a class="button" href="https://gonative.io/?url=https://powertech0417.github.io/Cv_ap/" target="_blank">
                    ç«‹å³ç”Ÿæˆ APK
                </a>
                <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ï¼Œç„¶åï¼š</p>
                <ol>
                    <li>åœ¨ GoNative ç½‘ç«™ç¡®è®¤æ‚¨çš„ç½‘å€</li>
                    <li>ç‚¹å‡» "Build App"</li>
                    <li>ä¸‹è½½ç”Ÿæˆçš„ APK æ–‡ä»¶</li>
                </ol>
            </div>
            
            <div class="step">
                <h3>ğŸ”§ æ–¹æ³•2ï¼šå…¶ä»–ç”ŸæˆæœåŠ¡</h3>
                <a class="button" href="https://www.web2apk.com/create?url=https://powertech0417.github.io/Cv_ap/" target="_blank">
                    Web2APK
                </a>
                <a class="button" href="https://www.appsgeyser.com/create/?url=https://powertech0417.github.io/Cv_ap/" target="_blank">
                    AppsGeyser
                </a>
            </div>
            
            <div class="step">
                <h3>ğŸ“‹ åº”ç”¨ä¿¡æ¯</h3>
                <ul>
                    <li><strong>ç½‘å€ï¼š</strong>https://powertech0417.github.io/Cv_ap/</li>
                    <li><strong>åº”ç”¨åç§°ï¼š</strong>æˆ‘çš„ç®€å†</li>
                    <li><strong>åŒ…åï¼š</strong>com.powertech0417.cvapp</li>
                </ul>
            </div>
        </body>
        </html>
        EOF
        
    - name: Upload Download Page
      uses: actions/upload-artifact@v4
      with:
        name: apk-download-page
        path: download-apk.html
